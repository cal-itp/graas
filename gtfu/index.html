
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.1">
    
    
      
        <title>General Transit Feed Utilities - GRaaS Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.23b6d78a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#general-transit-feed-utilities" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GRaaS Documentation" class="md-header__button md-logo" aria-label="GRaaS Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GRaaS Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              General Transit Feed Utilities
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GRaaS Documentation" class="md-nav__button md-logo" aria-label="GRaaS Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    GRaaS Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          General Transit Feed Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        General Transit Feed Utilities
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vehicle-position-feed" class="md-nav__link">
    Vehicle Position Feed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-alert-feed" class="md-nav__link">
    Service Alert Feed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-alert-ui" class="md-nav__link">
    Service Alert UI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#realtime-operator-visualization" class="md-nav__link">
    Realtime Operator Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trip-list-utility" class="md-nav__link">
    Trip List Utility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gtfs-validator" class="md-nav__link">
    GTFS Validator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-build" class="md-nav__link">
    To Build
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../server/onboarding-runbook/" class="md-nav__link">
        Runbook
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../server/" class="md-nav__link">
        Server
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../hardware/" class="md-nav__link">
        Hardware
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../attribution/" class="md-nav__link">
        Attribution
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vehicle-position-feed" class="md-nav__link">
    Vehicle Position Feed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-alert-feed" class="md-nav__link">
    Service Alert Feed
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-alert-ui" class="md-nav__link">
    Service Alert UI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#realtime-operator-visualization" class="md-nav__link">
    Realtime Operator Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trip-list-utility" class="md-nav__link">
    Trip List Utility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gtfs-validator" class="md-nav__link">
    GTFS Validator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-build" class="md-nav__link">
    To Build
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="general-transit-feed-utilities">General Transit Feed Utilities</h1>
<p>This repository provides a number of tools and utilities to monitor GTFS realtime feeds. The tools are detailed in the sections below. The Realtime Visualization component is very suitable for high-level validation of both static GTFS and Vehicle Position feeds for an operator. Finally, there is a utility to post Service Alerts.</p>
<h2 id="vehicle-position-feed">Vehicle Position Feed</h2>
<p>A command line utility that continuously displays vehicle position data for an operator to a terminal window.</p>
<p><img alt="Vehicle Positions" src="img/vehicle-positions.png" /></p>
<p>For each vehicle, when available, we display the distance traveled since the last update, the heading (indicated by an arrow), speed and time since last time. Vehicle IDs are shown with a green, yellow or red background, depending on how stale their last update is.</p>
<p>To run: <code>scripts/monitor-position-updates.sh -url &lt;vehicle-position-url&gt;</code></p>
<p>With Docker and Docker Compose: <code>docker-compose run positions_feed -url &lt;vehicle-position-url&gt;</code></p>
<h2 id="service-alert-feed">Service Alert Feed</h2>
<p>A command line utility that dumps active alerts for an operator to a terminal window.</p>
<p><img alt="Service Alerts" src="img/service-alerts.png" /></p>
<p>To run: <code>scripts/dump-service-alerts.sh &lt;service-alert-url&gt;</code></p>
<p>With Docker and Docker Compose: <code>docker-compose run service_alerts &lt;service-alert-url&gt;</code></p>
<h2 id="service-alert-ui">Service Alert UI</h2>
<p>A desktop app to let a user post GTFS service alerts.</p>
<p><img alt="Alert UI" src="img/alert-ui.png" /></p>
<p>To run: <code>scripts/alert-ui.sh -url &lt;path-to-config-file&gt;</code></p>
<p>Below is an example for a config file. Make sure to substitute the appropriate values for your scenario.</p>
<pre><code class="language-json">{
    &quot;private_key_file&quot;: &quot;/Users/foo/id_rsa&quot;,
    &quot;static_gtfs_url&quot;: &quot;http://operator.com/gtfs.zip&quot;,
    &quot;post_url&quot;: &quot;https://operator.com/post-service-alert&quot;
}
</code></pre>
<h2 id="realtime-operator-visualization">Realtime Operator Visualization</h2>
<p>Provides ongoing realtime visualization for a GTFS-rt compliant operator. Visuals are created by combining the static GTFS data with the realtime Vehicle Position Feed.</p>
<p><img alt="Realtime Visualization" src="img/big-blue-bus.png" /></p>
<p>Coordinates are auto-scaled to display all routes for an operator. Routes are drawn in the colors specified in the GTFS file. Stops are drawn in gray, vehicles are shown in magenta. Clicking on a stop shows the stop name, clicking on a vehicle shows the schedule adherence status (early, on time, late). In the upper left corner, we show the operator name, and vehicle, stop and trip count.</p>
<p>The first time data for an operator is shown, the system downloads and caches the static GTFS zip file. On subsequent runs, the modification time of the zip URL is checked against the cache timestamp. If the URL content is newer, we update the cache.</p>
<p>The vehicle position feed is sampled every few seconds, and any updates are reflected on the screen.</p>
<p>Pressing <code>n</code> or <code>p</code> switches to the next or previous operator feed, respectively. We show a loading overlay while switching operators. The overlay has two progress bars, data download up top and data parsing at the bottom.</p>
<p>To run: <code>scripts/realtime-visualization.sh &lt;path-to-config-file&gt;</code></p>
<p>Below is an example for a config file. Make sure to substitute the appropriate values for your scenario.</p>
<pre><code class="language-json">[
    {
        &quot;agency_id&quot;: &quot;agency-1&quot;,
        &quot;static_gtfs_url&quot;: &quot;http://agency-1.com/gtfs.zip&quot;,
        &quot;vehicle_position_url&quot;: &quot;http://agency-1.com/vehicle-positions.pb&quot;
    },
    {
        &quot;agency_id&quot;: &quot;agency-2&quot;,
        &quot;static_gtfs_url&quot;: &quot;http://agency-2.com/gtfs.zip&quot;,
        &quot;vehicle_position_url&quot;: &quot;http://agency-2.com/vehicle-positions.pb&quot;
    },
]
</code></pre>
<h2 id="trip-list-utility">Trip List Utility</h2>
<p>A command line utility for generating a list of friendly trip names from a static GTFS feed. This is part of the onboarding process for new operators, see <a href="https://github.com/cal-itp/graas-staging/blob/master/server/doc/onboarding-runbook.md">here</a> for more details.</p>
<p>To run: <code>scripts/dump-service-alerts.sh &lt;tmp-dir&gt; &lt;agency-id&gt; &lt;static-gtfs-url&gt;</code></p>
<p>With Docker and Docker Compose: <code>docker-compose run trip_list_generator &lt;tmp-dir&gt; &lt;agency-id&gt; &lt;static-gtfs-url&gt;</code></p>
<p>Use something like <code>/tmp/gtfu-cache</code> as <code>tmp-dir</code>.</p>
<h2 id="gtfs-validator">GTFS Validator</h2>
<p>This library utilizes <a href="https://github.com/mobilitydata/gtfs-validator">MobilityData's gtfs-validator tool</a>. It runs as a part of the TripListGenerator tool, and you can also run it with the command: <code>java -cp build/libs/gtfu.jar gtfu.tools.GTFSValidator &lt;agency-static-gtfs-url&gt;</code></p>
<h2 id="to-build">To Build</h2>
<p><code>gradle distZip</code></p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
        
        <a href="../server/onboarding-runbook/" class="md-footer__link md-footer__link--next" aria-label="Next: Runbook" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Runbook
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.c7dec7e7.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.da79ceb7.min.js"></script>
      
    
  </body>
</html>